{% extends "base.html.twig" %}

{% block title %}Metrics Analys{% endblock %}

{% block body %}
<h1>Metrics Analys</h1>

<h2>Introduktion</h2>
<p>
De sex C:na för kodkvalitet är:
<ul>
  <li><b>Codestyle</b> – enhetlig kodstil gör koden lättare att läsa.</li>
  <li><b>Coverage</b> – hur stor andel av koden som testas (min kod: 23%).</li>
  <li><b>Complexity</b> – komplexa metoder är svårare att förstå (Phpmetrics visade snitt CC ≈ 2.7).</li>
  <li><b>Cohesion</b> – hur väl en klass/metoder hänger ihop.</li>
  <li><b>Coupling</b> – hur beroende moduler är av varandra.</li>
  <li><b>CRAP</b> – kombination av komplexitet och låg coverage.</li>
  <li><b>Code Smell</b> – extra varningar, t.ex. duplicerad kod.</li>
</ul>
</p>

<h2>Phpmetrics</h2>
<p>Exempel på treemap från analysen:</p>
<img src="{{ asset('img/phpmetrics-treemap.png') }}" alt="Phpmetrics treemap">

<h2>Scrutinizer</h2>
<p>
Analysen visade:
<ul>
  <li>Duplicerad kod i vissa controllers.</li>
  <li>Långa metoder som borde delas upp.</li>
  <li>Låg coverage (från 17%, nu 23%).</li>
</ul>
</p>

<p>Badges:</p>
<p>
  <a href="https://scrutinizer-ci.com/g/kamhaal/mvc/">
    <img src="https://scrutinizer-ci.com/g/kamhaal/mvc/badges/quality-score.png?b=main" alt="Quality Score">
  </a>
  <a href="https://scrutinizer-ci.com/g/kamhaal/mvc/">
    <img src="https://scrutinizer-ci.com/g/kamhaal/mvc/badges/build.png?b=main" alt="Build Status">
  </a>
  <a href="https://scrutinizer-ci.com/g/kamhaal/mvc/">
    <img src="https://scrutinizer-ci.com/g/kamhaal/mvc/badges/coverage.png?b=main" alt="Coverage">
  </a>
</p>

<h2>Förbättringar</h2>
<ul>
  <li>Lagt till tester för Dice → coverage 100%.</li>
  <li>Förbättrat tester för Game → coverage 83%.</li>
  <li>Fixat namespace för BookType och lagt till test.</li>
</ul>

<h2>Resultat</h2>
<table cellpadding="5">
  <tr>
    <th>Metrik</th>
    <th>Före</th>
    <th>Efter</th>
    <th>Koppling</th>
  </tr>
  <tr>
    <td>Coverage</td>
    <td>17%</td>
    <td>23%</td>
    <td>Coverage</td>
  </tr>
  <tr>
    <td>Dice</td>
    <td>0%</td>
    <td>100%</td>
    <td>Coverage, Complexity</td>
  </tr>
  <tr>
    <td>Game</td>
    <td>80%</td>
    <td>83%</td>
    <td>Coverage</td>
  </tr>
</table>

<h2>Diskussion</h2>
<p>
Att aktivt jobba med kodkvalitet fungerar bra. Fördelar är renare kod, bättre tester
och färre buggar. Nackdelar är att det tar lite extra tid.  
Andra sätt att jobba mot clean code är att använda automatiska linters, kodgranskning
och CI/CD som alltid kör tester.
</p>

{% endblock %}
